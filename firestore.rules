
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Reglas para la colección 'invitations'
    match /invitations/{slug} {

      // Subcolección 'guests' (para RSVP)
      // Cualquiera puede crear un documento (enviar su confirmación)
      match /guests/{guestId} {
        allow create: if true;

        // Solo los usuarios autenticados (administradores) pueden leer, actualizar o borrar.
        allow read, update, delete: if request.auth != null;
      }

      // Subcolección 'photos' (para el álbum de invitados)
      match /photos/{photoId} {
      
        // Cualquiera puede leer la lista de fotos (para ver la galería)
        // Cualquiera puede crear un documento (añadir la metadata de una foto subida)
        allow read, create: if true;

        // Solo los usuarios autenticados (administradores) pueden actualizar o borrar.
        allow update, delete: if request.auth != null;
      }
    }
  }
}

    