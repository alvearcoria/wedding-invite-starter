rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Invitations collection
    match /invitations/{slug} {

      // Guests subcollection: Allow anyone to create (submit RSVP)
      match /guests/{guestId} {
        allow create: if true;
        // Only authenticated users (admins) can read/update/delete
        allow read, update, delete: if request.auth != null;
      }

      // Photos subcollection:
      // Allow anyone to create (upload photo metadata)
      // Allow anyone to read (view the gallery)
      match /photos/{photoId} {
        allow create, read: if true;
        // Only authenticated users (admins) can update/delete
        allow update, delete: if request.auth != null;
      }
    }
  }
}
